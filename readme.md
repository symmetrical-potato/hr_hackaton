# STUDENTOR

## Общее описание проекта
Основные сущности в проекте будут работодатель, студент, тема диплома/стажировка/практика(это будет, вероятно, одна сущность в бд), также будет сущность, отвечающая за хранение документов.

Мы хотим для каждой темы диплома составлять рейтинг студентов, которые могут выполнить эту дипломную работоу наиболее качественно, то же самое для стажировок и практик.

Будет то же самое и со стороны студента. Ему будут рекомендоваться темы диплома, основанные на текстовых данных курсовых работ, которые он делал ранее.

По сути это будет рекомендательная система, как со стороны студента, так и со стороны работодателя.

## Как запустить
Для работы данного приложения требуется:
1. Python 3.6.4
2. Postgresql 9.6+
3. ElasticSearch  6.0+
4. jdk 8

После установки всего ПО требуется настроить его конфигурацию.
Для этого скачиваем файлы [отсюда](https://goo.gl/kxDNj8) и распаковываем .zip архивы куда-нибудь.
1. Установить requirements.txt
2. В postgresql создаем базу данных studentor. После этого нужно загрузить дамп бд. Это можно сделать командой 
`psql -U postges -d studentor -f path/to/files/studentor_dump`
3. Помимо этого нужно запустить elasticsearch. Это можно сделать командой
`./path/to/elastic/directory/elasticsearch/bin/elasticsearch`
4. Если все прошло успешно, то нужно загрузить данные о дипломах и стажировках в elasticsearch.
В package проекта text есть два скрипта load_diplomas.py и load_internships.py, которые нужно запустить, предварительно указав путь до нужных файлов (Он там захардкожен).
5. После того, как все это сделано можно нужно написать команду `export FLASK_APP=run_server.py` и запустить сервер командой `flask run`.

Все работает! Вы восхитительны!

Для запуска задачи на скачивание новых данных требуется:
1. RabbitMQ 3.5.7 (`sudo apt-get install rabbitmq-server`)
2. Celery (включен в requirements.txt)

Чтобы запустить задачу, необходимо:
1. Создать переменную окружения `VK_API_KEY`, которая должна содержать сервисный ключ доступа для api
vkontakte.
2. Изменить период запуска задачи в файле config.py, если требуется.
3. Запустить rabbitmq (`sudo rabbitmq-server`), подробнее [тут](http://docs.celeryproject.org/en/latest/getting-started/brokers/rabbitmq.html#broker-rabbitmq)
4. Запустить задачу командой `celery -A data_loader.data_loader_task worker -B` из директории
проекта


